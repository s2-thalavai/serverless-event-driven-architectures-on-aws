# Enrich event data using an Amazon EventBridge Pipe.

## Technical Task Description

This exercise demonstrates how to use an Amazon EventBridge Pipe to filter and enrich events in transit. 
The Pipe reads messages from an SQS queue, enriches them through a Lambda function that queries a DynamoDB table, 
and publishes the enhanced data to an SNS topic.

## High-Level Architecture Overview

<img width="1387" height="848" alt="image" src="https://github.com/user-attachments/assets/ad3e3d85-90a8-4eb6-ab6a-5dbbf9dc9c7f" />

## Core AWS Components Used

| Component             | Purpose                                                         |
| --------------------- | --------------------------------------------------------------- |
| **Amazon SQS**        | Decouple message producers from consumers. Source for the Pipe. |
| **EventBridge Pipes** | Connects source to target; adds filtering and enrichment.       |
| **AWS Lambda**        | Enriches messages with extra data from DynamoDB.                |
| **Amazon DynamoDB**   | Stores enrichment data (e.g., lookup information).              |
| **Amazon SNS**        | Publishes final messages to subscribers (email, etc.).          |

## Overview of the Pipe Flow

### 1. SQS Queue (Source)

- The SQS queue will receive messages (for example, from an application or another AWS service).

- This will act as the EventBridge Pipe source.

### 2. EventBridge Pipe

- The Pipe connects the SQS queue (source) to the Lambda function (target).

- It applies filters to only process relevant messages.

- It also supports enrichment, which you’ll perform using the Lambda function.

### 3. Lambda Function (Enricher)

- The Lambda function will be invoked by the Pipe when a filtered message arrives.

- It will fetch additional data from DynamoDB to enrich the message.

- The enriched message will then be published to the SNS topic.

### 4. DynamoDB Table

- Stores data that the Lambda function uses to enrich incoming messages (e.g., user info, product details, etc.).

### 5. SNS Topic (Destination)

- Receives the enriched message from the Lambda function.

- Publishes the message to subscribers, such as an email endpoint.

### 6. Email Subscriber

- You’ll subscribe an email address to the SNS topic to receive the final, enriched event notifications.


## Step

### 1. Create an SNS Topic

- Use AWS Management Console or CLI.

- Add an email subscription to test the final message delivery.

### 2. Create an SQS Queue

- This will act as your EventBridge Pipe source.

- Send test messages here to trigger the flow.

### 3. Create a DynamoDB Table

- Example: CustomerData with CustomerId as the partition key.

- Populate it with sample data for enrichment.

### 4. Create a Lambda Function

- The function should:

    - Parse incoming events.
    
    - Fetch enrichment data from DynamoDB.
    
    - Return the combined message payload.

### 5. Create an EventBridge Pipe

- **Source:** SQS queue

- **Filter:** Add a simple filter rule (e.g., {"detail-type": ["order-created"]})

- **Enrichment:** The Lambda function

- **Target:** SNS topic

### 6. Test the Flow

- Send a test message to the SQS queue.

- Watch it flow through:

   - EventBridge Pipe (filter + enrich)
    
  - Lambda (enrich with DynamoDB data)
    
  - SNS (publish to topic)
    
  - Email (receive the final message)
